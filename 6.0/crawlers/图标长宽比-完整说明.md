# å›¾æ ‡é•¿å®½æ¯”åŠŸèƒ½ - å®Œæ•´è¯´æ˜

## ğŸ¯ æ ¸å¿ƒæ¦‚å¿µ

### é—®é¢˜
- æ¸¸æˆä¸­å¡ç‰‡æœ‰3ç§å°ºå¯¸ï¼šSmallã€Mediumã€Large
- ä¸‹è½½çš„å›¾æ ‡éƒ½æ˜¯å›ºå®š 256Ã—256ï¼Œæ— æ³•ä»æ–‡ä»¶è·å–çœŸå®æ¯”ä¾‹
- éœ€è¦ä»**ç½‘é¡µHTMLä¸­æå–å¡ç‰‡å°ºå¯¸**ï¼Œç„¶åæ˜ å°„åˆ°é•¿å®½æ¯”

### è§£å†³æ–¹æ¡ˆ
**å¡ç‰‡å°ºå¯¸ â†’ å›¾æ ‡é•¿å®½æ¯”æ˜ å°„ï¼š**
- **Small** â†’ 0.5 (ç«–é•¿å›¾ï¼Œå®½:é«˜ = 1:2)
- **Medium** â†’ 1.0 (æ­£æ–¹å½¢ï¼Œå®½:é«˜ = 1:1)
- **Large** â†’ 1.5 (æ¨ªé•¿å›¾ï¼Œå®½:é«˜ = 3:2)

---

## âœ… æµ‹è¯•éªŒè¯ï¼ˆAhexa æ€ªç‰©ï¼‰

å·²é€šè¿‡æµ‹è¯•ï¼ŒæˆåŠŸç‡ 4/4ï¼š

| ç‰©å“åç§° | å°ºå¯¸ | é•¿å®½æ¯” | ç»“æœ |
|---------|------|--------|------|
| Crypto | Small | 0.5 | âœ“ |
| Rapid Injection System | Medium | 1.0 | âœ“ |
| Solar Farm | Large | 1.5 | âœ“ |
| Virus | Small | 0.5 | âœ“ |

**æµ‹è¯•å‘½ä»¤ï¼š**
```bash
cd 6.0/crawlers
python test_extract_size.py
```

---

## ğŸ“¦ å·²æ›´æ–°çš„è„šæœ¬

### 1. selenium_monster_v3.py âœ… å·²æ›´æ–°

**æ–°å¢åŠŸèƒ½ï¼š**
- è®¿é—®å¡ç‰‡è¯¦æƒ…é¡µæ—¶è‡ªåŠ¨æå–å°ºå¯¸
- æ ¹æ®å°ºå¯¸è®¡ç®—é•¿å®½æ¯”
- ä¿å­˜åˆ° JSON çš„ `aspect_ratio` å­—æ®µ

**æ–°å¢å‡½æ•°ï¼š**
```python
extract_card_size(html)           # ä»HTMLæå–å°ºå¯¸
size_to_aspect_ratio(size)        # å°ºå¯¸è½¬æ¢ä¸ºé•¿å®½æ¯”
get_card_description(driver, url) # è¿”å› (description, size)
```

**è¾“å‡ºç¤ºä¾‹ï¼š**
```
[Ahexa]
  å¤„ç†ç‰©å“è¯¦æƒ…...
    [Crypto]
      âœ“ æè¿°: At the start of each hour... [Small, æ¯”ä¾‹:0.5]
    [Rapid Injection System]
      âœ“ æè¿°: When you Poison yourself... [Medium, æ¯”ä¾‹:1.0]
    [Solar Farm]
      âœ“ æè¿°: Haste your other items... [Large, æ¯”ä¾‹:1.5]
    [Virus]
      âœ“ æè¿°: Poison yourself... [Small, æ¯”ä¾‹:0.5]
```

---

### 2. selenium_event_final.py âŒ ä¸éœ€è¦æ›´æ–°

**åŸå› ï¼š**
- æ‰€æœ‰äº‹ä»¶é€‰æ‹©å›¾æ ‡éƒ½æ˜¯ 1:1 æ­£æ–¹å½¢
- é»˜è®¤å€¼å·²ç»æ˜¯ 1.0
- æ— éœ€é¢å¤–å¤„ç†

---

### 3. update_existing_aspect_ratios.py â­ æ–°å»º

**åŠŸèƒ½ï¼š** ä¸ºç°æœ‰æ•°æ®æ‰¹é‡æ·»åŠ é•¿å®½æ¯”

**ä½¿ç”¨åœºæ™¯ï¼š**
- å·²æœ‰å®Œæ•´çš„æ€ªç‰©æ•°æ®ï¼Œä½†ç¼ºå°‘ `aspect_ratio` å­—æ®µ
- éœ€è¦ä¸ºæ‰€æœ‰ç‰©å“å’ŒæŠ€èƒ½è¡¥å……é•¿å®½æ¯”ä¿¡æ¯

**ç‰¹ç‚¹ï¼š**
- âœ… å¢é‡æ›´æ–°ï¼ˆå·²æœ‰çš„è·³è¿‡ï¼‰
- âœ… å¢é‡ä¿å­˜ï¼ˆæ¯å¤„ç†å®Œä¸€ä¸ªæ€ªç‰©ç«‹å³ä¿å­˜ï¼‰
- âœ… æ–­ç‚¹ç»­ä¼ ï¼ˆä¸­æ–­åå¯ç»§ç»­ï¼‰
- âœ… è‡ªåŠ¨å¤‡ä»½åŸæ•°æ®
- âš ï¸ éœ€è¦ç½‘ç»œè¿æ¥å’ŒChromeæµè§ˆå™¨
- âš ï¸ éœ€è¦è¾ƒé•¿æ—¶é—´ï¼ˆæ¯ä¸ªå¡ç‰‡è®¿é—®ä¸€æ¬¡ç½‘é¡µï¼‰

**ä½¿ç”¨æ–¹æ³•ï¼š**
```bash
cd 6.0/crawlers
python update_existing_aspect_ratios.py
```

**é¢„æœŸæ—¶é—´ï¼š**
- 104ä¸ªæ€ªç‰© Ã— å¹³å‡7ä¸ªç‰©å“ â‰ˆ 700+ å¡ç‰‡
- æ¯ä¸ªå¡ç‰‡ 2ç§’ â‰ˆ 25åˆ†é’Ÿå·¦å³

---

## ğŸ“Š æ•°æ®æ ¼å¼

### monsters_v3.jsonï¼ˆå·²æ›´æ–°ï¼‰

```json
{
  "name": "Ahexa",
  "skills": [],
  "items": [
    {
      "name": "Crypto",
      "icon": "icons/Ahexa_Crypto.webp",
      "description": "...",
      "aspect_ratio": 0.5
    },
    {
      "name": "Rapid Injection System",
      "icon": "icons/Ahexa_Rapid Injection System.webp",
      "description": "...",
      "aspect_ratio": 1.0
    },
    {
      "name": "Solar Farm",
      "icon": "icons/Ahexa_Solar Farm.webp",
      "description": "...",
      "aspect_ratio": 1.5
    },
    {
      "name": "Virus",
      "icon": "icons/Ahexa_Virus.webp",
      "description": "...",
      "aspect_ratio": 0.5
    }
  ]
}
```

### events_final.jsonï¼ˆä¸éœ€è¦æ›´æ–°ï¼‰

```json
{
  "name": "A Strange Mushroom",
  "choices": [
    {
      "name": "Trade It for Something",
      "icon": "icons\\A Strange Mushroom\\Trade It for Something.webp",
      "description": "...",
      "aspect_ratio": 1.0
    }
  ]
}
```
*æ³¨ï¼šäº‹ä»¶æ•°æ®å¯ä»¥æ‰‹åŠ¨æ·»åŠ  aspect_ratio: 1.0ï¼Œä¹Ÿå¯ä»¥ä¸åŠ ï¼ˆBazaar_Lens.py é»˜è®¤å€¼æ˜¯1.0ï¼‰*

---

## ğŸ”„ å®Œæ•´æ›´æ–°æµç¨‹

### åœºæ™¯1ï¼šæ¸¸æˆæ›´æ–°ï¼Œçˆ¬å–æ–°æ•°æ®

```bash
cd 6.0/crawlers

# 1. å¤‡ä»½
python backup_current_data.py

# 2. è·å–æœ€æ–°åç§°
python simple_crawler.py
python fetch_monster_name.py
python fetch_event_name.py

# 3. å¯¹æ¯”æ–°å¢
python compare_names.py

# 4. çˆ¬å–æ–°å¢é¡¹ï¼ˆè‡ªåŠ¨åŒ…å«é•¿å®½æ¯”ï¼‰
python selenium_monster_v3.py
# äº‹ä»¶ä¸éœ€è¦æ›´æ–°é•¿å®½æ¯”
python selenium_event_final.py

# 5. æ£€æŸ¥
python check_data_completeness.py
```

---

### åœºæ™¯2ï¼šä¸ºç°æœ‰æ•°æ®æ·»åŠ é•¿å®½æ¯”

```bash
cd 6.0/crawlers

# æ–¹å¼A: æµ‹è¯•å…ˆï¼ˆæ¨èï¼‰
python test_extract_size.py
# å¦‚æœæµ‹è¯•é€šè¿‡ï¼ˆ4/4ï¼‰ï¼Œç»§ç»­ï¼š

# æ–¹å¼B: æ‰¹é‡æ›´æ–°
python update_existing_aspect_ratios.py
# ä¼šæç¤ºéœ€è¦æ›´æ–°çš„æ•°é‡ï¼Œè¾“å…¥ y ç¡®è®¤
```

---

## ğŸ› ï¸ æŠ€æœ¯ç»†èŠ‚

### å°ºå¯¸æå–æ–¹æ³•

```python
def extract_card_size(html):
    """ä»HTMLæå–å°ºå¯¸"""
    # ä½¿ç”¨å¤šä¸ªæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼åŒ¹é…
    patterns = [
        r'<span[^>]*>\s*(Small|Medium|Large)\s*</span>',
        r'<div[^>]*>\s*(Small|Medium|Large)\s*</div>',
        r'"size"\s*:\s*"(Small|Medium|Large)"',
    ]
    # è¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…çš„å°ºå¯¸
```

### é•¿å®½æ¯”è®¡ç®—

```python
def size_to_aspect_ratio(size):
    """å°ºå¯¸ â†’ é•¿å®½æ¯”"""
    mapping = {
        'SMALL': 0.5,   # ç«–é•¿
        'MEDIUM': 1.0,  # æ­£æ–¹
        'LARGE': 1.5,   # æ¨ªé•¿
    }
    return mapping.get(size.upper(), 1.0)
```

### Bazaar_Lens.py ä½¿ç”¨

```python
# è¯»å–é•¿å®½æ¯”
aspect_ratio = float(item.get('aspect_ratio', 1.0))

# è®¡ç®—å›¾æ ‡å®½åº¦
icon_height = 96  # å›ºå®šé«˜åº¦
icon_width = int(icon_height * aspect_ratio)

# æ˜¾ç¤ºæ•ˆæœï¼š
# Small (0.5)  â†’ 48Ã—96  ç«–é•¿
# Medium (1.0) â†’ 96Ã—96  æ­£æ–¹å½¢
# Large (1.5)  â†’ 144Ã—96 æ¨ªé•¿
```

---

## âš ï¸ é‡è¦æç¤º

### âœ… éœ€è¦åšçš„
1. **æ€ªç‰©æ•°æ®** - å¿…é¡»æ›´æ–°ï¼ˆç‰©å“æœ‰ä¸åŒæ¯”ä¾‹ï¼‰
2. **æ–°çˆ¬å–** - ä½¿ç”¨æ›´æ–°åçš„ `selenium_monster_v3.py`
3. **ç°æœ‰æ•°æ®** - è¿è¡Œ `update_existing_aspect_ratios.py`

### âŒ ä¸éœ€è¦åšçš„
1. **äº‹ä»¶æ•°æ®** - å…¨éƒ¨æ˜¯1.0ï¼Œä¸éœ€è¦æ›´æ–°
2. **ä»å›¾æ ‡æ–‡ä»¶** - æ— æ³•è·å–ï¼ˆéƒ½æ˜¯256Ã—256ï¼‰
3. **æ‰‹åŠ¨è®¡ç®—** - è‡ªåŠ¨ä»ç½‘é¡µæå–

---

## ğŸ“ˆ ç»Ÿè®¡ç¤ºä¾‹

è¿è¡Œ `update_existing_aspect_ratios.py` åï¼š

```
æ‰¹é‡æ›´æ–°æ€ªç‰©æ•°æ®çš„é•¿å®½æ¯”
================================================================================
åŠ è½½æ•°æ®...
âœ“ å·²åŠ è½½ 104 ä¸ªæ€ªç‰©
âœ“ åŸæ•°æ®å·²å¤‡ä»½: monsters_v3.json.backup_before_aspect

ç»Ÿè®¡:
  æ€»é¡¹ç›®æ•°: 716
  éœ€è¦æ›´æ–°: 561  (æ‰€æœ‰ç‰©å“)
  å·²æœ‰é•¿å®½æ¯”: 155 (æŠ€èƒ½é»˜è®¤ä¸º1.0)

å°†è®¿é—® 561 ä¸ªå¡ç‰‡é¡µé¢è·å–å°ºå¯¸ä¿¡æ¯
ç»§ç»­å—? (y/n): y

[1/104] Banannibal
  ç‰©å“: Med Kit
    âœ“ Small â†’ 0.5
  ç‰©å“: Bluenanas
    âœ“ Small â†’ 0.5
  ç‰©å“: Duct Tape
    âœ“ Medium â†’ 1.0
  âœ“ å·²ä¿å­˜è¿›åº¦

...

================================================================================
æ›´æ–°å®Œæˆï¼
================================================================================
  æ›´æ–°é¡¹ç›®æ•°: 561
  æˆåŠŸæå–: 558
  ä½¿ç”¨é»˜è®¤å€¼: 3

âœ“ æ•°æ®å·²ä¿å­˜åˆ°: monster_details_v3/monsters_v3.json
================================================================================
```

---

**æœ€åæ›´æ–°ï¼š** 2025-10-10  
**ç‰ˆæœ¬ï¼š** v6.0  
**æµ‹è¯•çŠ¶æ€ï¼š** âœ… å·²éªŒè¯ï¼ˆAhexa 4/4é€šè¿‡ï¼‰



